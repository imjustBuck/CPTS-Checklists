Green Flags for Binary/DLL Analysis (CPTS Focus)

## âœ… 1. **Service or Scheduled Task points to it**

- You find a **custom** or **weird-looking service** or **scheduled task** running an unknown `.exe` or `.dll`.
    
- Especially if the `binpath` has **spaces without quotes** (priv esc vuln).
    

â†’ _**Time to check it.**_

---

## âœ… 2. **Itâ€™s located in a writable path**

- Example:
    
    - `C:\Program Files\` â€” **not writable** (safe)
        
    - `C:\Temp\weird_tool.exe` â€” **probably writable** (red flag!)
        
    - `C:\Users\Public\Documents\something.dll` â€” **hijack me please**
        

â†’ _**Writable = exploitation window.**_

---

## âœ… 3. **Filename suggests security, admin, or auth function**

- Examples: `authService.exe`, `PasswordManager.dll`, `vpnconnector.exe`, `internalTools.exe`
    
- Stuff that **might touch creds**, login flows, or network configs.
    

â†’ _**If the name screams "auth" or "internal tool" â€” worth a fast look.**_

---

## âœ… 4. **Binary is running as SYSTEM, Administrator, or high-priv account**

- Even if you donâ€™t understand what it does yet â€” if it's running as SYSTEM, any **small hijack** or **exec abuse** = full box takeover.
    

â†’ _**Always worth checking SYSTEM-owned binaries.**_

---

## âœ… 5. **Binary is suspiciously large or small**

- Normal executables are ~300KB to 5MB.
    
- If you see a tiny 12KB `vpnconn.exe` or a massive 800MB `.dll`, it's worth poking:
    
    - Tiny size = possibly a wrapper that calls another binary (DLL hijack chance)
        
    - Huge size = might be packed with hardcoded configs/secrets.
        

â†’ _**Size anomalies = investigate briefly.**_

---

# âŒ When **NOT** to Waste Time:

|Situation|Skip It|
|---|---|
|Normal system32 binaries (`notepad.exe`, `calc.exe`)|âœ…|
|Binaries with valid Authenticode signatures|âœ…|
|Service binaries with proper quotes, non-writable folders|âœ…|
|Random small DLLs for drivers, hardware utils|âœ…|
|No writable folder, no creds inside, no obvious function|âœ…|

---

# ðŸ“œ If Any Green Flag â†’ Run this 5-Command Binary Pillage:
``` CMD
strings suspicious.exe | less     # Look for creds/paths
exiftool suspicious.exe           # Check metadata
# If Windows:
Get-Content suspicious.exe | Select-String -Pattern "pass","key","token"
Get-ItemProperty -Path "HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*" | Select-Object DisplayName, InstallLocation  # Installed apps if needed
ls -Recurse | findstr ".exe .dll .config"   # Crawl for related files
```



## ðŸŽ¯ When to Trigger This:

- Found a suspicious `.exe`, `.dll`, `.config`, or `.bin` during post-exploitation.
    
- Found custom tools, scripts, or service binaries during enumeration.
    
- Service or scheduled task points to a weird binary path.
    

---

## ðŸ“œ Rapid Manual Analysis Steps:

-  **Run `strings` on it**:
    
    `strings filename.exe | less`
    
    > ðŸ”Ž Look for hardcoded passwords, API keys, IP addresses, usernames, creds.
    
-  **Check metadata with `exiftool`**:
    
    `exiftool filename.exe`
    
    > ðŸ”Ž Might reveal internal usernames, machine names, or source paths.
    
-  **Check dependencies (DLL hijacking clues)**:
    
    `ldd filename.exe     # (Linux) if cross-compiled`
    
    or use `PE-bear`, `pestudio`, or `Dependency Walker` on Windows.
    
-  **Identify writable paths in binary references**:
    
    > Ex: If a service binary expects `C:\Program Files\Something\lib.dll`, and that folder is writable = hijack possibility.
    

---

## ðŸ§  Optional Deeper Analysis (only if juicy):

-  **Use `dnSpy`** (for .NET executables) to view source code easily.
    
-  **Use `PE-bear` or `pestudio`** for basic PE structure inspection.
    
-  **If extreme case (rare):**
    
    - IDA Free
        
    - Ghidra (only if desperate and a known path is blocked)
        

---

## ðŸ›  Useful Tools:

|Tool|Purpose|
|---|---|
|`strings`|Pulls human-readable text|
|`exiftool`|Metadata analysis|
|`PE-bear`|PE header inspection (Windows binaries)|
|`pestudio`|Lightweight static analysis|
|`dnSpy`|Decompile/view C#/VB.NET code|
|`Dependency Walker`|DLL dependency checks|

---

## âš¡ Quick Mindset:

- **Look for passwords first.**
    
- **Look for service account usernames or API endpoints.**
    
- **Look for writable folders in the binaryâ€™s path.**
    
- **Move on quickly if nothing interesting after 5-10 minutes.**
